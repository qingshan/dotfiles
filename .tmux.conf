# remap prefix from 'C-b' to 'C-a'
set -g prefix 'C-\'
unbind-key C-b
bind-key 'C-\' send-prefix

# start window numbers at 1 to match keyboard order with tmux window order
set -g base-index 1
setw -g pane-base-index 1

# renumber windows sequentially after closing any of them
set -g renumber-windows on

# auto window rename
set -g automatic-rename on

# enable activity alerts
setw -g monitor-activity on
set -g visual-activity on

# increase scrollback lines
set -g history-limit 50000

# set clipboard
set -g set-clipboard on

# mouse behavior
set -g mouse on

# reload Tmux configuration
bind r source-file ~/.tmux.conf \; display-message "Config reloaded."

# splitting panes with current path
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# vi is good
setw -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
#bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel "xsel -i -p && xsel -o -p | xsel -i -b"
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle

# moving between panes.
bind -r h select-pane -L
bind -r j select-pane -D
bind -r k select-pane -U
bind -r l select-pane -R

# moving between windows with vim movement keys
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# resize panes with vim movement keys
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# remove confirmation questions when closing windows/panes
bind-key x kill-pane
bind-key & kill-window

# popup for sessions and ssh servers
bind-key C display-popup -E "~/.tmux/bin/commands"
bind-key S display-popup -E "~/.tmux/bin/sessions"

# shortcut for synchronize-panes toggle
bind-key I set-window-option synchronize-panes

# truecolor support
set-option -ga terminal-overrides ",xterm-256color:Tc"

# default terminal is 256 colors
set -g default-terminal "xterm-256color"

# aggressive resize
setw -g aggressive-resize off

# iTerm2 window name
set-option -g set-titles on

# user defined overrides

# if remoted in (via ssh), customize some things for convenient nesting
if-shell 'test -z "$SSH_CLIENT"' \
    'source-file ~/.tmux/tmux.conf.local'
if-shell 'test -n "$SSH_CLIENT"' \
    'source-file ~/.tmux/tmux.conf.remote'
